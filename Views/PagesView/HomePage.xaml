<UserControl x:Class="OfflineCodingBot.Views.PagesView.HomePage"
                      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:local="OfflineCodingBot.Views.PagesView"
             xmlns:components="clr-namespace:OfflineCodingBot.Views.Components.HomePageComponents"
             mc:Ignorable="d">

    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter" />

        <!-- Pulse Animation for Finished Typing -->
        <Storyboard x:Key="PromptPulse" RepeatBehavior="Forever" AutoReverse="True">
            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                             From="1.0" To="0.6"
                             Duration="0:0:1" />
            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                             From="1.0" To="1.05"
                             Duration="0:0:1" />
            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                             From="1.0" To="1.05"
                             Duration="0:0:1" />
        </Storyboard>
    </UserControl.Resources>

    <Grid Background="Transparent">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="280" MinWidth="100" />
            <!-- splitter -->
            <ColumnDefinition Width="*" MinWidth="100" />

            <!-- splitter -->
            <ColumnDefinition Width="Auto" MinWidth="100" />
        </Grid.ColumnDefinitions>

        <!-- Left: SettingsPage -->
        <components:SettingsPage Grid.Column="0" DataContext="{Binding SettingsVM}" Margin="0" />

        <!-- Middle: Existing UI -->
        <StackPanel Grid.Column="1"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Top"
                Width="Auto"
                MinWidth="400"
                Margin="20">

            <!-- Title -->
            <TextBlock Text="MFX AI Models Loader"
                       FontSize="38"
                       FontWeight="Bold"
                       Foreground="#2B2B2B"
                       HorizontalAlignment="Center"
                       Margin="0 0 0 30" />

            <!-- AI Typing Text -->
            <TextBlock x:Name="PromptText"
                       FontSize="18"
                       Foreground="#555"
                       HorizontalAlignment="Center"
                       Margin="0 0 0 25"
                       RenderTransformOrigin="0.5,0.5">
                <TextBlock.RenderTransform>
                    <ScaleTransform ScaleX="1" ScaleY="1" />
                </TextBlock.RenderTransform>
            </TextBlock>

            <!-- Input Row -->
            <Grid Margin="0,0,0,25" Height="35">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="110" />
                </Grid.ColumnDefinitions>

                <TextBox Text="{Binding ModelPath, UpdateSourceTrigger=PropertyChanged}"
                         Grid.Column="0"
                         Padding="5"
                         FontSize="14"
                         VerticalContentAlignment="Center" />

                <Button Content="Browse"
                        Command="{Binding BrowseModelCommand}"
                        Grid.Column="1"
                        Margin="8,0,0,0"
                        Background="#4CAF50"
                        Foreground="White"
                        FontWeight="SemiBold"
                        BorderThickness="0"
                        Cursor="Hand" />
            </Grid>

            <!-- Next Button -->
            <Button Content="Next"
                    Command="{Binding NextCommand}"
                    IsEnabled="{Binding CanGoNext}"
                    Width="100" Height="35"
                    Background="#2196F3"
                    Foreground="White"
                    FontWeight="SemiBold"
                    BorderThickness="0"
                    Cursor="Hand"
                    HorizontalAlignment="Right" />

            <!-- Progress Bar -->
            <ProgressBar Height="20"
                         Margin="0,15,0,0"
                         Minimum="0"
                         Maximum="100"
                         Value="{Binding LoadingProgress}"
                         Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}"
                         Foreground="#4CAF50"
                         Background="#EEE" />

            <!-- Recommended Models Section -->
            <StackPanel Margin="0,40,0,0">
                <TextBlock Text="Recommended Models"
                           FontWeight="Bold"
                           FontSize="24"
                           Foreground="#222222" />
                <TextBlock Text="These models have been tested and work reliably with this app."
                           FontSize="12"
                           Foreground="#666666"
                           Margin="0,4,0,20" />

                <!-- Meta LLama: Most Important Model -->
                <Border Background="White"
        BorderBrush="#2B2B2B"
        BorderThickness="2"
        CornerRadius="6"
        Padding="15"
        Margin="0,0,0,15"
        SnapsToDevicePixels="True"
        Effect="{DynamicResource DropShadowEffect}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="120" />
                        </Grid.ColumnDefinitions>

                        <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                            <TextBlock Text="Meta LLama 3 8B Q3K L"
                       FontSize="14"
                       FontWeight="Bold"
                       Foreground="#222222"
                       TextTrimming="CharacterEllipsis" />
                            <TextBlock Text="Size: 4.32 GB - Accuracy: 80%" 
                       FontSize="12"
                       Foreground="#555555"
                       Margin="0,4,0,0"/>
                        </StackPanel>

                        <Button Content="Download"
                Grid.Column="1"
                Width="100"
                Height="32"
                Background="#4CAF50"
                Foreground="White"
                FontWeight="SemiBold"
                BorderThickness="0"
                Cursor="Hand"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                Click="DownloadMetaLLama_Click" />
                    </Grid>
                </Border>

                <!-- DeepSeek Model Q4_0 -->
                <Border Background="White"
        BorderBrush="#DDD"
        BorderThickness="1"
        CornerRadius="6"
        Padding="15"
        Margin="0,0,0,15"
        SnapsToDevicePixels="True">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="120" />
                        </Grid.ColumnDefinitions>

                        <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                            <TextBlock Text="DeepSeek Model Q4_0"
                       FontSize="12"
                       FontWeight="SemiBold"
                       Foreground="#222222"
                       TextTrimming="CharacterEllipsis" />
                            <TextBlock Text="Size: 0.99 GB - Accuracy: 55%" 
                       FontSize="12"
                       Foreground="#555555"
                       Margin="0,4,0,0"/>
                        </StackPanel>

                        <Button Content="Download"
                Grid.Column="1"
                Width="100"
                Height="32"
                Background="#4CAF50"
                Foreground="White"
                FontWeight="SemiBold"
                BorderThickness="0"
                Cursor="Hand"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                Click="DownloadDeepSeek_Click" />
                    </Grid>
                </Border>

                <!-- Qwen3 1.7B Q8_0 -->
                <Border Background="White"
        BorderBrush="#DDD"
        BorderThickness="1"
        CornerRadius="6"
        Padding="15"
        Margin="0,0,0,15"
        SnapsToDevicePixels="True">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="120" />
                        </Grid.ColumnDefinitions>

                        <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                            <TextBlock Text="Qwen3 1.7B Q8_0"
                       FontSize="12"
                       FontWeight="SemiBold"
                       Foreground="#222222"
                       TextTrimming="CharacterEllipsis" />
                            <TextBlock Text="Size: 2.1 GB - Accuracy: 62%" 
                       FontSize="12"
                       Foreground="#555555"
                       Margin="0,4,0,0"/>
                        </StackPanel>

                        <Button Content="Download"
                Grid.Column="1"
                Width="100"
                Height="32"
                Background="#4CAF50"
                Foreground="White"
                FontWeight="SemiBold"
                BorderThickness="0"
                Cursor="Hand"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                Click="DownloadQueenSeek_Click" />
                    </Grid>
                </Border>


                <!-- View More Models Link -->
                <TextBlock Margin="0,20,0,0"
                           FontSize="12"
                           Foreground="#1E90FF"
                           TextDecorations="Underline"
                           Cursor="Hand"
                           Text="View more models on Hugging Face"
                           MouseLeftButtonUp="OpenHuggingFaceLink" />

            </StackPanel>

        </StackPanel>



        <!-- Right: Latest Opened Models -->
        <StackPanel Grid.Column="2"
                Margin="0"
                Background="#FFF"
                VerticalAlignment="Stretch"
                HorizontalAlignment="Right"
                MaxWidth="600">


            <TextBlock Text="Latest Opened Models"
                       FontWeight="Bold"
                       FontSize="20"
                       HorizontalAlignment="Center"
                       Margin="0,10,0,15"
                       Foreground="Gray" />

            <ListBox ItemsSource="{Binding RecentModels}"
                     SelectedItem="{Binding SelectedRecentModel, Mode=TwoWay}"
                     BorderBrush="#DDD"
                     BorderThickness="1"
                     Background="White"
                     Height="600"
                     
                     HorizontalContentAlignment="Stretch"
                     ScrollViewer.VerticalScrollBarVisibility="Auto">

                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <Grid Margin="5,2">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="80" />
                            </Grid.ColumnDefinitions>

                            <TextBlock Text="{Binding}"
                                       TextTrimming="CharacterEllipsis"
                                       VerticalAlignment="Center"
                                       FontSize="14"
                                       Foreground="#444"
                                       Margin="4,0" />

                            <Button Content="Load"
                                    Command="{Binding DataContext.LoadRecentModelCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                    CommandParameter="{Binding}"
                                    Grid.Column="1"
                                    Width="70"
                                    Height="28"
                                    Margin="5,0"
                                    Background="#4CAF50"
                                    Foreground="White"
                                    FontWeight="SemiBold"
                                    BorderThickness="0"
                                    Cursor="Hand" />

                        </Grid>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>

        </StackPanel>

    </Grid>
</UserControl>

